{
    "app-id": "${APP_ID}",
    "runtime": "org.freedesktop.Platform",
    "runtime-version": "19.08",
    "sdk": "org.freedesktop.Sdk",
    "command": "${PROJECT_NAME}",
    "finish-args": [
        "--share=ipc",
        "--share=network",
        "--socket=x11",
        "--socket=wayland",
        "--system-talk-name=org.freedesktop.GeoClue2",
        "--device=dri"
    ],
    "modules": [
        {
            "name": "qt5-qtbase",
	    "cleanup-platform": [ "/bin", "/mkspecs" ],
            "build-options" : {
                "arch" : {
                    "x86_64" : {
                        "config-opts" : [
                            "-reduce-relocations", "-force-debug-info"
                        ]
                    },
                    "arm" : {
                        "config-opts" : [
                            "-no-reduce-relocations", "-optimize-size", "-opengl es2"
                        ]
                    },
                    "aarch64" : {
                        "config-opts" : [
                            "-no-reduce-relocations", "-optimize-size", "-opengl es2"
                        ]
                    }
                }
            },
            "config-opts": [ "-confirm-license", "-opensource",
                             "-shared",
                             "-platform", "linux-g++",
                             "-optimized-qmake",
                             "-nomake", "examples",
                             "-nomake", "tests",
                             "-system-harfbuzz",
                             "-system-sqlite",
                             "-accessibility",
                             "-dbus-linked",
                             "-fontconfig",
                             "-glib",
                             "-icu",
                             "-openssl-linked",
                             "-no-pch",
                             "-no-rpath",
                             "-no-directfb",
                             "-no-linuxfb",
                             "-no-kms",
                             "-system-proxies",
                             "-gtk",
                             "-no-use-gold-linker"
                           ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://download.qt.io/archive/qt/5.15/5.15.0/submodules/qtbase-everywhere-src-5.15.0.tar.xz",
                    "sha256": "9e7af10aece15fa9500369efde69cb220eee8ec3a6818afe01ce1e7d484824c5"
                },
                {
                    "type": "shell",
                    "commands": [ "mv configure configure.qt" ]
                },
                {
                    "type": "script",
                    "commands": [
                        "processed=`sed -e 's/--/-/g ; s/=/ /g' <<< $@`",
                        "./configure.qt $processed"
                    ],
                    "dest-filename": "configure"
                }
            ]
        },
        {
            "name": "qt5-qttools",
            "buildsystem": "qmake",
            "cleanup-platform": [
                "/mkspecs",
                "/bin/assistant", "/bin/qhelpgenerator", "/bin/qcollectiongenerator", "/bin/qhelpconverter", "/bin/pixeltool", "/bin/designer",
                "/bin/lrelease", "/bin/lupdate", "/bin/lconvert", "/bin/linguist", "/bin/qdoc", "/bin/qtattributionsscanner",
                "/bin/qtplugininfo", "/bin/qtdiag", "/bin/qdbusviewer"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://download.qt.io/archive/qt/5.15/5.15.0/submodules/qttools-everywhere-src-5.15.0.tar.xz",
                    "sha256": "ddbcb49aab3a2e3672582c6e2e7bec0058feff790f67472343c79e2895e0e437"
                }
            ]
        },
        {
            "name": "qt5-qtlocation",
            "buildsystem": "qmake",
            "cleanup-platform": [ "/bin", "/mkspecs" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://download.qt.io/archive/qt/5.15/5.15.0/submodules/qtlocation-everywhere-src-5.15.0.tar.xz",
                    "sha256": "c68b0778a521e5522641c41b1778999dd408ebfda1e0de166a83743268be5f3f"
                }
            ]
        },
        {
            "name": "qt5-qtdeclarative",
            "buildsystem": "qmake",
            "cleanup-platform": [ "/bin", "/mkspecs", "lib/plugins/qmltooling" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://download.qt.io/archive/qt/5.15/5.15.0/submodules/qtdeclarative-everywhere-src-5.15.0.tar.xz",
                    "sha256": "9c3c93fb7d340b2f7d738d12408c047318c78973cb45bfc5ff6b3a57e1fef699"
                }
            ]
        },
        {
            "name": "qt5-qtsvg",
            "buildsystem": "qmake",
            "cleanup-platform": [ "/bin", "/mkspecs" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://download.qt.io/archive/qt/5.15/5.15.0/submodules/qtsvg-everywhere-src-5.15.0.tar.xz",
                    "sha256": "ee4d287e2e205ca8c08921b9cbe0fc58bf46be080b5359ad4d7fbdee44aeee0d"
                }
            ]
        },
        {
            "name": "qt5-qtquickcontrols2",
            "buildsystem": "qmake",
            "cleanup-platform": [ "/bin", "/mkspecs" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://download.qt.io/archive/qt/5.15/5.15.0/submodules/qtquickcontrols2-everywhere-src-5.15.0.tar.xz",
                    "sha256": "839abda9b58cd8656b2e5f46afbb484e63df466481ace43318c4c2022684648f"
                }
            ]
        },
        {
            "name": "qt5-wayland",
            "buildsystem": "qmake",
            "cleanup-platform": [ "/bin", "/mkspecs" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://download.qt.io/archive/qt/5.15/5.15.0/submodules/qtwayland-everywhere-src-5.15.0.tar.xz",
                    "sha256": "084133e10bfbd32a28125639660c59975f23457bba6a79b30a25802cec76a9fb"
                }
            ]
        },
        {
            "name": "qt5-qtx11extras",
            "buildsystem": "qmake",
            "cleanup-platform": [ "/bin", "/mkspecs" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://download.qt.io/archive/qt/5.15/5.15.0/submodules/qtx11extras-everywhere-src-5.15.0.tar.xz",
                    "sha256": "c72b6c188284facddcf82835af048240e721dc8d6d9e8a7bd71d76fd876881a1"
                }
            ]
        },
        {
            "name": "enroute",
            "buildsystem": "cmake-ninja",
            "config-opts": ["-DCMAKE_BUILD_TYPE=RelWithDebInfo"],
            "sources": [
                {
		    "type": "git",
                    "url": "https://github.com/Akaflieg-Freiburg/enroute.git",
		    "commit": "${GIT_COMMIT}"
                }
            ]
        }
    ]
}
